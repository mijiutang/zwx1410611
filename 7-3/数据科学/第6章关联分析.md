# 第6章关 联 分 析
### 6.1 啤酒与尿布

#### 6.1.1  案例详析

“啤酒与尿布”(图6-1)的故事可以说是营销界的经典段子。这个故事产生于20世 纪90年代的美国沃尔玛超市中，沃尔玛的超市管理人员在分析销售数据时发现了一个令 人难以理解的现象：在某些特定的情况下，啤酒与尿布两件看上去毫无关系的商品会经常 出现在同一个购物篮中，而且，啤酒与尿布在周末的时候销量明显会高于平时。这种独特 的销售现象引起了管理人员的注意。他们经过后续调查发现，这种现象出现在年轻的父亲 身上。

![图6- 1 啤酒与尿布](图6-1_placeholder)

管理人员对这个现象进行了分析，原来在美国有婴儿的家庭中， 一般是母亲在家中照看  婴儿，年轻的父亲前去超市购买尿布。每当周末来临，年轻的父亲们下班回家路上，被要求  去购尿布。当他们在购买尿布的同时，往往会顺便为自己购买啤酒，以方便自己周末时候消 遣。这样就出现了啤酒与尿布这两件看上去不相干的商品经常会出现在同一个购物篮的现象。

如果这些年轻的父亲在卖场只能买到两件商品之一，则他很有可能会放弃购物而到另 一 家商店，直到可以一次同时买到啤酒与尿布为止。

沃尔玛发现了这一独特的现象后，便开始在卖场尝试将啤酒与尿布摆放在相同的区域， 让年轻的父亲可以同时找到这两件商品，并很快地完成购物。而沃尔玛超市也因可以让这些 客户一次购买两件商品，而不是一件，从而获得了很好的商品销售收入，这就是“啤酒与尿 布”故事的由来。

那么,为什么“啤酒与尿布”的故事会产生在沃尔玛的卖场中呢?

原因来自于两个方面：

1. 沃尔玛先进的计算机技术。它是“啤酒与尿布”故事产生的强大后盾。零售业目 前使用的很多新技术都是沃尔玛率先“尝鲜”的，比如沃尔玛最早在门店尝试计算机记账，  最早在门店收款台尝试使用外形丑陋、俗称“牛眼”的条码扫描器进行收款等。“前人栽树， 后人乘凉”,目前运用于门店管理的很多技术手段都是沃尔玛做了“第一个吃螃蟹”的，后人 只不过坐享其成而已。由于沃尔玛具备先进的技术手段，“啤酒与尿布”的故事在沃尔玛发生 就一点也不奇怪了。
2. 沃尔玛运用了大数据的分析方法，强调通过对数据的分析来指导卖场管理。沃尔 玛创始人老沃尔顿说过一句话 “Retail  is  Detail (零售就是细节)”。也就是说，要善于分析数 据，善于理解数据，从细节入手，通过对数字、记录等的分析，来找出其中的模式和规律， 辅助理解客户的购买行为，从而提升卖场效率。这正是数据科学的研究理念：从一些人们往 往容易忽略的细节中去发现真正有用的信息。

#### 6.1.2 购物篮分析法

购物篮分析 (Market   Basket   Analysis), 即通过对顾客在超级市场内付款时，购物篮内所 装的商品的登记结算记录的分析，来研究顾客的购买行为。通过购物篮分析挖掘出来的信息 可以指导交叉销售和追加销售、商品促销、顾客忠诚度管理、库存管理和折扣计划。购物篮 分析法，曾经是沃尔玛秘而不宣的独门武器。

按照所关注的内容不同，可以将购物篮分析法分为两大类：美式购物篮分析法和日式购 物篮分析法。美式购物篮分析法的代表是美国的沃尔玛(图6-2),而日式购物篮分析法的 代表则是日本的7-11便利店(图6-3)。

![图6-2 美式购物篮分析法的代表——沃尔玛](图6-2_placeholder)

![图6-3 日式购物篮分析法的代表——7-11便利店](图6-3_placeholder)

这两种方法虽然同属购物篮分析法，但所关注的研究内容各有侧重：

1. **美式购物篮分析法**。

美式购物篮分析法以沃尔玛(图6-2)为代表。这种类型的卖场一般面积巨大，通常都  有上万平方米，商品种类繁多，大多在10万种以上。不同种类的商品陈列区域之间可能相差 几十米，甚至可能是“楼上、楼下”的陈列关系。如果是对该卖场的商品摆放位置不熟悉的  顾客，要找到所需要的多种类型的商品，可能需要大量时间，而且有很大难度。所以就要考  虑将一些有关联的商品放置在一起，方便顾客购物，同时减少每个顾客购物的平均所需时间。 但是，如此众多的商品，如此繁多的关系，很难通过人工方式，去找出不同区域商品之间的  关联关系，并将这些关联关系用于商品关联陈列、促销等具体工作中，因此，需要利用购物  篮分析法完成。

因此，美式购物篮分析法的重点是分析购物篮内商品之间的关联关系。这种方法适合应 用于类似沃尔玛这样的大卖场，用于找出不同陈列区域商品之间的关系。英国的 Tesco  连锁 超市、Safeway 连锁超市也都是运用这种购物篮分析法的高手。

2. **日式购物篮分析法**。

日式购物篮分析法以7-11便利店为代表。7-11便利店营业面积都很小， 一般只有100~  250平方米，商品品种3000～10000种。站在门店里任何一个角落，所有的商品转个身就全 看见了——所以找出商品关联关系不是重点：你就是找出来啤酒与尿布之间有“暗恋”关系， 也没用!因为啤酒与尿布本来就在一起。

当然日本7-11便利店这类相关陈列的故事也是有的，比如荞麦冷面与纳豆、鱼肉香肠 与面包、酸奶与盒饭等，但是毕竟起不到主要作用。日式购物篮分析法的研究重点是分析所 有影响商品销售的关联因素，比如天气、温度、时间、事件、客户群体等对店内商品销售的 影响。

相比于沃尔玛，日本7-11便利店更关注的是：

1. 气温由28℃上升到30℃,对碳酸类饮料、凉面的销售量会有什么影响?
2. 下雨的时候，关东煮的销售量会有什么变化?
3. 盒饭加酸奶、盒饭加罐装啤酒都针对什么样的客户群体?他们什么时间到门店买这些 商品?

7-11 便利店会设置专门的气象部门，而且会要求门店每天5次将门店内外的温度、湿 度上传回总部，供总部与商品销售进行对比分析。

日式购物篮分析法对于所有影响商品销售的关联因素研究得非常透彻，因此，日本才会 有碳酸饮料指数、空调指数、冰激凌指数。

不论是美式购物篮分析法，还是日式购物篮分析法，有几个关键因素都是需要注意的：

1. 选择正确的品项。谁都知道三文鱼和芥末之间有关联关系了，所以在研究购物篮时， 没有必要再把他们作为研究的对象。这已经是已知的事实，应该把研究的重点放在那些未知 的物品联系上。
2. 正确理解和识别相关关系背后的含义。通过数据分析，发现了相关关系后，还需要去 做调查研究，弄清楚这些相关关系背后的原因。只有清楚了原因，才能采取正确的方法去运 用这些相关关系。
3. 实际技术的支持。比如，所选择的品项愈多，计算所耗费的资源与时间愈久(呈现指 数递增),此时必须运用一些技术可以降低资源与时间的损耗。

#### 6.1.3  商品间相关性分析

商品间相关性分析是美式购物篮分析法研究的重点。那么,如何才能从浩如烟海又杂乱 无章的销售数据中，发现类似于啤酒和尿布这类商品销售之间的联系呢?这就需要用到数据 挖掘技术。

所谓数据挖掘 (Data      Mining), 就是从数据库的大量数据中揭示出隐含的、先前未知的  并有潜在价值的信息的非平凡过程。数据挖掘是目前人工智能和数据库领域研究的热点问题。

数据挖掘是一种决策支持过程，它主要基于人工智能、机器学习、模式识别、统计学、 数据库、可视化技术等，高度自动化地分析企业的数据，做出归纳性的推理，从中挖掘出潜 在的模式，帮助决策者调整市场策略，减少风险，从而做出正确的决策。

数据挖掘是通过分析每个数据，从大量数据中寻找其规律的技术，主要有数据准备、规 律寻找和规律表示3个步骤。数据准备是从相关的数据源中选取所需的数据，并整合成用于 数据挖掘的数据集；规律寻找是用某种方法将数据集所含的规律找出来；规律表示是尽可能 以用户可理解的方式(如可视化)将找出的规律表示出来。

数据挖掘的任务有关联分析、聚类分析、分类分析、异常分析、特异群组分析和演变分 析等。

在进行商品间的相关性分析时，有三个关键性指标必须重视：支持度 (Support) 、 置信 度 (Confidence) 、 提高度 (Lift) 。 在进行研究时，以支持度、置信度作为主要商品相关性分 析指标，而以提高度指标来强化说明关联关系。

##### 6.1.3.1  支持度

支持度，就是支持某一事件发生的概率，即表示商品A 和商品B 同时出现在购物篮中的 概率 (A  和 B 同时出现这一事件的概率)。

即如果考虑商品A 对商品B 的支持度，则支持度S(A→B)     的计算方式为：

(6-1)

其中，N 代表总的事件个数，而N(A&B)    代表购物篮中同时出现A 和 B 的事件次数。

如果S 值很低，那么代表所研究的规则普遍性一般，应用层次太低。举例来说，比如啤 酒与尿布同时出现在购物篮中的概率是20%,则称啤酒与尿布的支持度是20%。

从支持度的计算公式中可以看出，如果啤酒与尿布同时出现在购物篮中的概率是20%, 则啤酒对尿布的支持度是20%,而尿布对啤酒的支持度也是20%。

回想之前“啤酒与尿布”的故事，是否可以认为“啤酒与尿布”等同于“尿布与啤酒” 的故事呢?

在回答这个问题之前，先来考虑一下“啤酒与尿布”的故事出现其背后的原因。故事中， 年轻的父亲去超市的目的是购买尿布。在买到尿布的前提下，才会考虑购买啤酒。因此在购  买尿布的父亲中有35%购买了啤酒，不代表购买了啤酒的父亲有35%购买了尿布。这是两类  不同的消费行为，商品之间的因果关系也会不同，因此这个故事不能反过来讲。

而当单纯计算支持度时，是没法体现这种不同的，所以在计算商品之间的支持度时，需 要反过来计算进行验证，看看两个商品之间的相关性具有多少的可信度，从而寻找商品之间 的因果关系。

表6-1中显示了某超市购物篮分析的结果，从中也可以看出，买了商品 A 的顾客又购 买了商品B 的百分比是不等同于买了商品B 的顾客又购买了商品A 的百分比的。所以，还需 要计算置信度，来验证相关关系。

**表6- 1 商品间相关性**

| 商品名称                | 鸡蛋1% | 金丝猴豆干上 汤鸡汁30 g/% | 中号袋/% | 特价商品1% | 精粉馒头1% | 400g盐/1% |
| ----------------------- | ------ | ------------------------- | -------- | ---------- | ---------- | --------- |
| 鸡蛋                    | 无     | 13                        | 12.7     | 12.0       | 9.6        | 9         |
| 金丝猴豆干 上汤鸡汁 30g | 40     | 无                        | 12.7     | 12.7       | 25.5       | 9.1       |
| 中号袋                  | 28     | 9.3                       | 无       | 9.3        | 12         | 4         |
| 特价商品                | 25.6   | 9.0                       | 9.0      | 无         | 18         | 7.7       |
| 精粉馒头                | 35.6   | 8.9                       | 20       | 31.1       | 无         | 6.7       |
| 400g盐                  | 42.9   | 14.3                      | 8.6      | 17.1       | 2.9        | 无        |

##### 6.1.3.2  置信度

置信度，指的是特定个体对特定命题真实性相信的程度，也就是特定命题令人信服的水平。 举例来说，这就是指顾客在一次购物中，购买了商品A 的同时，又购买了商品B 的概率。这 其实是一个条件概率的问题，即在商品A 出现的情况下商品B 同时出现在购物篮中的可能性。

如果考虑商品A 对商品B 的置信度，则置信度C(A→B)   的计算方式为：

(6-2)

其中，N(A&B)     代表购物篮中同时出现 A  和 B  的事件次数，N(A)     代表购物篮中出现 A

的事件次数。

我们知道：

同理可以推出，商品A 对商品A 本身的支持度为：

于是，可以推出：

(6-3)

(6-4)

(6-5)

从置信度的定义可以看出C(A→B)   不等同于C(B→A),   因而可以利用置信度来区分 两种商品之间的对等相关关系。

如果商品A 对商品B 的置信度水平高，那么代表了购买了商品A 的顾客会再购买商品B 这种特定事件出现的可能性就很高。

而在做商品相关性分析时，希望得到的规则是同时具有很高的支持度和置信度的规则。 如果支持度高，但是置信度低，那么这个规则令人信服的程度就会下降；如果反过来，那么 意味着这个规则产生的普遍性不高，但是置信水平还可以。

##### 6.1.3.3  提高度

提高度是对支持度和置信度进行全面衡量和补充的一项指标，它表征了商品之间的亲密 关系，也可称为兴趣度。它实际反映了商品A 的出现对于商品B 被购买的影响程度。

当考虑商品A 对商品 B 的提高度时，提高度L(A→B) 的计算方式为：

(6-6)

商品B 对自身的支持度为：

(6-7)

将  式 ( 6 - 3 ) 、  式 ( 6 - 5 ) 和  式 ( 6 - 7 ) 代 入  式 ( 6 - 6 )  可 得 ：

(6-8)

整理得到：

(6-9)

式中，P(A&B)   代表了商品A 和商品B 同时出现在购物篮中的概率，而P(A)代表了商品A 出现在购物篮中的概率，P(B) 代表了商品B出现在购物篮中的概率。

由式(6-9)可以看出，若商品A 对商品B 的提高率等于1,表明商品A 和商品B 同时 出现在购物篮中的概率等同于商品A 出现在购物篮中的概率乘以商品B出现在购物篮中的概 率。根据概率学相关知识可知，在这种情况下，商品A 和商品B 出现在购物篮中的行为是完 全无关的。即所有顾客对于商品A 和商品B 的购买行为是完全独立的。

而当商品A 对商品B 的提高率大于1时，表明商品A 和商品B 的购买行为之间是正向 关联的，数值越大，表明其关联性越强。

若商品A 对商品B 的提高率小于1,则代表商品A 和商品B 的购买行为之间是互斥关系， 即对商品A 的购买会减弱购买商品B 的意愿。

##### 6.1.3.4  相关性指标计算示例

**题目**：若某购物篮记录为：

- 消费者1:啤酒、蛋糕、薯条、阿司匹林。
- 消费者2:尿布、婴儿乳液、葡萄汁、婴儿食品、牛奶。
- 消费者3:雪碧、薯条、牛奶。
- 消费者4:啤酒、牛奶、冰激凌、薯条。
- 消费者5:雪碧、咖啡、牛奶、面包、啤酒。
- 消费者6:啤酒、薯条。

请计算：

1. S    (啤酒 → 薯条)
2. S     (牛奶 → 雪碧)
3. C    (啤酒 → 薯条)
4. L   (啤酒 → 薯条)

**解答**：

1. **计算啤酒对薯条的支持度**：

2. **计算牛奶对雪碧的支持度**：

3. **计算啤酒对薯条的置信度**：

4. **计算啤酒对薯条的提高度**，首先计算薯条对薯条的支持度：

再计算啤酒对薯条的提高度：

啤酒对薯条的提高度大于1,由此可见购买啤酒的行为对于购买薯条的行为是有促进作 用 的 。

##### 6.1.3.5  商品相关性的运用

通过对支持度、置信度和提高度的计算，可以发现商品之间的相关性。而了解了某些商  品的相关性后，就可以合理地运用。比如交叉陈列，即把互相正关联的商品放置在一起，这  样可以方便顾客购物，节约顾客的购物时间，并且可以通过心理暗示的方式提升关联购买率。 或者将互相关联的商品直接捆绑销售，从而提升销售额。

这里列举几个典型的案例：

1. **皮蛋、豆腐和青豆**。

某超市，通过商品相关性分析，发现皮蛋、豆腐和青豆出现在同一个购物篮的比例很高， 即这三者之间存在关联关系。通过进一步调查，发现该超市所属区域中有许多的饭店。这些 饭店经常到这家超市购买这三样商品来制作“皮蛋豆腐”。而饭店往往是在客户点菜后，才匆 忙到超市购买皮蛋、豆腐和青豆。由于超市很近，买完东西后再回去给客户做菜也不耽误。为 了让这些饭店购物更方便，该超市将这三样商品直接陈列在一起。一个月后，对这三样商品 进行关联分析发现，三种商品陈列在一起后，极大地缩短了顾客寻找商品的时间，三种商品 的销售额分别上升了5%、8%、3%,商品关联度也进一步增加。

2. **菠菜和色拉酱**。

这是一个发生在日本零售业的案例。日本某商店将一种拌色拉用的丘比酱放在菠菜旁边  销售。原来一星期只能销售658把的菠菜，关联陈列后销售量增加至1650把，增长了151%。 而丘比酱也从原来的一星期只销售19瓶增加到了300瓶，增长了1478.9%。之所以会出现如  此的效果，是因为在日本，菠菜一般都是作为色拉主菜食用的。该商店将菠菜和丘比酱放在  一起关联陈列之后，当顾客忙碌了一天下班后进入商店时，心里正嘀咕着“今天晚饭吃什么 ”, 一看到摆在货架上的菠菜和丘比酱，就会突然有了想法，“行了，菠菜色拉，就是它了”。于  是，两个商品的销售业绩均得到大幅提升。这个例子和超市里会在冷冻柜台上面摆放饺子醋  是一个道理，是在暗示客户买速冻饺子的时候，别忘了带点醋回家。

3. **互斥关联关系的运用**

商品之间的互斥关系也是有用处的。例如，有的商店在摆放鞋油的货架上， 一口气陈列 30～40种的鞋油，而这些鞋油使用方法相同、价格相近，只是形状不同而已。其实，通过商 品相关性分析可知，这些鞋油其实是存在互斥关联关系的。像这样陈列互斥的鞋油，会造成 货架的浪费，同时过多的商品选择反而会造成客户无所适从，无法做出购买决定，客户会干 脆放弃购物。因此，比较合理的方案是在一个货架上不应出现5个以上的互斥商品，这样， 既满足了客户的购买需求，也使货架资源的使用得以优化。

##### 6.1.4  外界因素的影响

日式购物篮分析法的研究重点在于找出外界各种因素对商品销售情况的影响。这其实也 是一种相关性分析，只是分析的对象不同而已。

通过日式购物篮分析法，找出外界因素对购物行为的影响后，可以配合形成心理暗示来 提示购买，或者根据外界因素来确定上架物品摆放情况、比例、位置。

比如，德国啤酒的“啤酒一气温指数”——根据研究发现，夏季气温每上升一度，就会 增加230万瓶的啤酒销量；日本空调指数——研究者发现夏季30℃以上的天气多一天，空调 销量即增加4万台；台湾七五三感冒指数——研究表明，在一天中如果最高温度、最低温度 相差7℃,昨天和今天温度相差5℃,且湿度差大于30%的话，感冒的人会增加，商家就要 考虑把感冒药、温度计和口罩之类的商品上架。

再比如，面包房即使不烤面包了，也要在烤箱里烤上点东西，把烘烤面包的香味散发出 去，勾起客户食欲，客户的双腿会不由自主地走到面包柜台。同样的，烤鸡味道也是一种极 其诱人的食品诱导味道，因此在很多卖场中一定要架上烤炉，现场烤鸡，并且一定要让味道 散发出来。

##### 6.1.5  思维启示

###### 6.1.5.1  启示一：不要只见树木，而不见森林

沃尔玛的“啤酒和尿布”故事并不是偶然产生的，它提示了在大数据时代， 一定要更多 地去从更为全面的角度去看问题，要看到事物之间的联系。

比如，如果在沃尔玛，每个人都只关注自己的“一亩三分地”,卖啤酒的只管闷头卖啤酒， 卖尿布的只管闷头卖尿布，每个柜台只关心自己的商品是否能进入客户手中的购物篮。卖啤 酒的不关心购物篮中的尿布，卖尿布的也漠视购物篮中的啤酒，只要别漏了自己柜台的东西 就行了。如果只是这样人人自扫门前雪，那么长期下去，商店的整体效益肯定不会好。而反 观沃尔玛的卖场管理体系，购物篮是主要的管理对象，而不仅是商品。

沃尔玛认为商品销售量的冲刺只是短期行为，而零售企业的生命力则取决于购物篮。 一 个小小的购物篮不仅体现了客户的真实消费需求和购物行为，而且每一只购物篮里都蕴藏着 太多的客户信息。零售业的宗旨是服务客户，沃尔玛认为商店的管理核心应该是以购物篮为 中心的顾客经营模式，商品排名只能体现商品自身的表现，而购物篮可以体现出客户的购买 行为及消费需求，关注购物篮可以使门店随时掌握客户的消费动向，从而使门店始终与客户 保持一致。也就是这种纵观全局的思维方式，让沃尔玛发现了啤酒与尿布之间的关系，从而 引发了后面的故事。

###### 6.1.5.2  启示二：注重相关关系的研究

“啤酒与尿布”故事的依据是商品之间的相关性(也称关联性),商品相关性是指商品在 卖场中不是孤立的，不同商品在销售中会形成相互影响的关系(也称关联关系),比如在“啤 酒与尿布”故事中，尿布会影响啤酒的销量。在卖场中商品之间的关联关系比比皆是，比如 咖啡的销量会影响到咖啡伴侣、方糖的销售量，牛奶的销量会影响面包的销售量等。

所谓事物之间的相关性是指当一个事物发生变化时，另一个事物也会发生变化。当事物 之间的变化是相互抵消的，比如猪肉价格上涨与猪肉销量下降，称这种相关性是负相关；当 事物之间的变化呈现同一个方向发展时(比如气温上升、冷饮销量也上升),称这种相关性是 正相关。

有些事物的相关性显而易见，有些则不是那么明显。美国华尔街股票分析师将女性超短 裙的长度与道琼斯股票指数建立了关联，超短裙的长度与股票指数成反比趋势，据说十分灵

验，这就是相关性在生活中的种种体现。

商店中的关联性更是比比皆是，比如烟酒销售的关联关系：当门店附近有建筑工地时， 低档烟、酒的销售就会上升；当附近有高档社区时，中华烟、葡萄酒的销售量就会上升。

商品相关性并不只是数据分析的事，更重要的是它反映了客户心理层面的因素，毕竟是 人在提着购物篮，而不是猴子。

客户在购物时的心理行为是产生商品之间关联关系的最基本原因。人们在运用数据科学 的相关手段时，就是从手头的数据来反向分析人心理因素的影响。在找到购物篮规律时，必 须从客户消费心理层面解释这些关联关系，否则“啤酒与尿布”会永远停留在啤酒与尿布这 两个商品身上，而没有任何的推广意义。要想详细地了解商品相关性形成的客户心理因素， 则需要进行大量的客户消费行为观察，构建客户购物篮场景，才可使“啤酒与尿布”的故事 发扬光大。

###### 6.1.5.3 启示三：深挖数据背后的含义

要想找到“啤酒与尿布”之间的关联关系，就要对客户手中的购物篮进行计算。

我们将单个客户一次购买商品的总和(以收银台结账为准)称为一个购物篮。比如，我 们在超市收银台一次购买了5件商品：啤酒、卫生纸、熟食、果汁饮料、大米，就可以认为 在这个购物篮中共有5件商品，在收款台交款时，这5件商品会集中体现在同一个收款小票 中。因此，一个购物篮就是一张收款小票，购物小票就是购物篮分析的一个重要依据。

别小看这一张购物小票，它并不简单，上面实际上包含了3个层面的含义。

1. 购买商品的客户：“啤酒与尿布”实际上是讲述了特定客户群体(年轻父亲)的消费 行为，如果忽略了这个特定的客户群体，“啤酒与尿布”的故事将会毫无意义。
2. 购物篮中的商品：同时出现在一个购物篮中的啤酒和尿布包含了很多要素，比如这 些啤酒与尿布同时出现是否具有规律性?啤酒和尿布的价格是多少?是否进行了促销 ……
3. 购物篮的金额信息：购买啤酒和尿布的客户使用了什么样的支付方式(是现金、银 行卡、会员储值卡，还是支票等)?

通常的超市里都有会员卡。通过会员卡分析 POS 机的消费数据，可以知道与每个特定会  员相关的购买数据信息。比如，通过分析某人的会员卡，可以知道这样的事实：老张今天买  了2瓶啤酒、一包花生米、2袋豆腐干；大前天老张买了4瓶啤酒、 一包开花豆、4袋豆腐干。

可是一个1000平方米的超市，像老张这样的客户一天可能有1000～2000个，这样的 数据看上一天也不会有什么结果，除了知道老张喜欢喝上一口，喜欢用花生米、豆腐干下酒， 其他的事情都不知道。

的确，了解一个又一个老张们的喝酒习惯对门店而言是没有意义的。门店需要知道的是， 门店有多少个老张?又有多少个与老张喝酒习惯不同的老李?将喝啤酒就花生米的老张与喝 干白葡萄酒就腰果的老李分开，分成不同的客户群体，对门店而言才是有意义的。比如门店 只要知道，在喜欢喝酒的100个客户里，有30个喝啤酒就花生米的老张，10个喝干白葡萄酒就腰果的老李，另外有20个老王是喝黄酒就豆腐干，这就足够了。门店这时就可以知道，啤酒与花生米有关联关系，干白葡萄酒与腰果有关联关系，黄酒与豆腐干有关联关系，这些商品可以考虑一起促销，或者摆放在相近的位置进行陈列。

###### 6.1.5.4 启示四：数据分析不要停留于表面

先举一个例子：

例子：某海滨城市超市周末上午会出现切片面包脱销的情况。于是超市管理人员想当然 地认为，这是由于到海滨旅游的家庭买了面包给小孩当早餐。于是他们依据标准的购物篮分 析法，开始丰富门店的切片面包品种，并提升其档次。另外，还参照交叉销售的模式，补充 与切片面包具有相关性的果酱、火腿肠、黄油等商品。但是，这样的举措却没有给门店销售 额带来提升。经过调查才发现，原来这个门店的切片面包是被前往海滨的钓鱼客买去，充当 钓鱼饵料使用。于是，管理人员将门店的切片面包调整为低档、低价的切片面包，并且开始 开发垂钓相关商品。

从这个例子中不难看出，发现现象后， 一定要深挖本质，不能只停留于表面。只有清楚 现象背后的原因，才能真正地利用这个规律。

数据分析师发现了规律后，还需要做深入的调查研究，弄明白规律背后隐含的道理 (图6 - 4)。

![图6-4 研究数据不应停留于表面](图6-4_placeholder)

### 6.2  亚马逊的个性化推荐

#### 6.2.1  案例详析

亚马逊是全球电子商务的创始者，是通过对数据的充分使用和挖掘而在商战中获胜的最 佳代表，被誉为在线商城，尤其是个性化推荐的领袖。过去十年，该公司已投入了大量的金 钱和智力来建成一套智能推荐系统，它会考虑历史浏览记录、过去的购买记录和其他购物者 的记录——所有这些都是为了确保访问者能买东西。

据统计，亚马逊销售额的1/3来自于它的个性化推荐系统(图6-5)。亚马逊利用用户在 亚马逊上的购买、浏览记录和行为历史，综合运用多种推荐算法：基于item 相似和相关性、 基于行为历史、基于协同过滤等，来实现个性化的推荐。

1994年杰夫 · 贝索斯创办了这家后来更名为亚马逊的电子商务公司。最初，亚马逊的推  荐内容全由人工完成。他们聘请了一个由20人组成的书评团队，专门负责写书评、推荐新书，

在亚马逊的网页上推荐有意思的新书。这个书评团队在那时对亚马逊书籍的销量有很大帮助。

![图6-5 亚马逊的个性化推荐系统](图6-5_placeholder)

但是，随着亚马逊网站上所售书籍的量越来越大，这种人工推荐方式的弊端不断涌现：

1. 需要投入大量人力、物力、时间，因为每本书籍都需要多个书评人来阅读，而阅读一 本书籍也需要大量时间；
2. 书评人有自己的偏好性，如何能够保证书评的恰当性、无偏差性、客观性?
3. 大部分书评人年纪比较大，如何保证与潮流大众的契合程度?
4. 书评的更新速度是一项非常重要的因素。

于是，亚马逊公司决定尝试更有创造性的做法，打算根据用户的习惯来为其推荐商品， 即利用推荐算法来实现个性化推荐。

最初他们所采用的推荐算法是将不同用户进行比较，希望找到用户之间的关联，从而去 推荐书籍。但是问题在于，面对庞大的数据，而算法过于烦琐，结果也会差强人意。

亚马逊当时的技术人员格雷格 ·林登思考之后，想出了一个解决方法：其实没有必要将 不同的用户进行比较，只需要找到产品之间的关联。运用这样的推荐方式可以提前分析出产 品之间的关系，于是推荐速度非常快，适用于不同产品，甚至可以跨界推荐商品。

林登将书评家带来的销售量和推荐系统产生的营销业绩进行了比较，发现推荐系统带来 的商品销量远远高于书评家，这个销量比较数据直接促成了亚马逊解散书评组，而由推荐系 统取代他们来推荐更可能受用户欢迎的产品。

这种基于海量数据的推荐，也是大数据早期运用的一种重要形式。

#### 6.2.2 亚马逊的推荐方式

亚马逊的大数据挖掘秘密简单来说有四步：

**第一步，收集用户行为数据。**

用户使用亚马逊网站上发生的所有行为都会被亚马逊记录：如搜索、浏览、打分、点评、 购买、使用减价券和退货等。所收集的历史记录包括：他们购买了什么书籍，哪些书他们只 浏览却没有购买，浏览了多久，哪些书是他们一起购买的，有了这些数据，亚马逊就能精准 地判断出用户的购物喜好。根据这些数据，亚马逊勾画出每个用户的特征轮廓和需求，并以 此为依据进行精准营销。

具体来说，亚马逊记录的用户行为数据包括：

1. 访问日志：用户的访问行为，包括IP、访问方式、地域、时间等。
2. 点击日志：用户的点击行为。
3. 会话日志：由点击日志生成的，可描述用户行为的日志形式，记录了用户的各种行为， 如浏览、购买、点击、评分和评论等。

**第二步，整合用户行为数据。**

完成了用户行为的数据收集后，亚马逊会分析会话日志，从用户的行为来了解他们的喜 好——看了什么书籍，买了什么书籍，收藏了什么书籍，为什么有些书看了却没买，或是等 了一段时间才买。

还会鼓励用户参与投票、书评(图6-6)。这其实是一种主动性地暴露用户兴趣爱好的 方式。可以透露用户的观点、倾向等。从而帮助亚马逊给用户打上“标签”。

```markdown
Customer  Reviews

★★★★t?526
47 out of5 suars
5   ste
4  stu
3   sta 2sta
1st     新	

75%
19%
4%
1%
1%	
Share your thoughts wth other customers W     acuct                i      
See  all  526  customer  reiews
Top   Customer   Revlews
★★★★★ probably the bek Wex&Weyne book to dat
By Sneaky Burrto TOP 100 REVIEWER on January 26.2016
Format Hardcover
have to adm I was knd of down on Brandon Sandarson's work for awhile ter reading the final bok n the Mstborn tnogy (ths was a fw years back)i kept   thinkong ugh another new metal orahoy Solstayed swey fom the Wax&Wayne books for a lorg trme Then lgo ofered ths book to renew and 1decded to
gm Sanderson's word another chance I rad AMoy odLaw and Shadows d Sat mmedately before Bands o Moumng andI ectualy npyed al tre qentoa
bt        (So        much        tha        I        μmped        nght        n        and        read        Words        of        Radance        immedtely        s减 er-1guess         I        needed         more        of        a        Sanderson        fx         i
So that is one point in ths boks fror Ater redng al tre of the curen Wax &Wayne books in a row (tha being the third)I wanted to ump into the next
one Onty t's not even witten yet so I hae to wat awmle.For wha its worth.this ia defnitely not going to work as a standaione You need to read the prenou
two Wax8Wayne books (unles in thea prerious paragaphj and t pays to hae some knomledge o the Mstborm tnlogy as woH t doesn hene to be ndeph
knoMedye 1read thos books probably more than the years ago and I remembered andeor was remnded of enough oer the course of readng to understand wa
was gong on)
Anyway bke the other two Wax&.Wayne books this one was tity shot (think ust ove 300 pegs thoughi wau reading t on Kindle sofm not 100%sure)and vry fst-peced Defnitely a quck read And there warent any slow pats Ithink Sanderson's weaknes is explaning background informulon.t can be pantul to
```

![图6-6 鼓励用户参与投票、书评等主观性活动](图6-6_placeholder)

**第三步，个性化推荐营销服务。**

接下来，就是利用推荐算法，通过对所获取到的用户行为数据的分析和理解，来实现个 性化推荐服务。通过推荐服务，不仅可以提高客户购买的意愿，缩短购买的路径和时间，还 可以在恰当的时机捕获客户的最佳购买冲动，降低传统营销方式对客户的无端骚扰。

**第四步，统计用户反馈数据。**

正如一个稳定的系统一般，推荐系统也需要一个反馈环节。亚马逊的个性化推荐包含两 种形式：在线的推荐；线下的推荐，如邮件方式，或其他的线下推送方式。

那么对于在线推荐形式，需要收集的反馈行为数据包括：

1. 用户会浏览推荐的书籍，并直接购买。
2. 用户也许会浏览，但不直接购买。
3. 用户可能会直接反馈推荐效果(这不是我想要的)。

4. 用户也许不会浏览。

而对于线下推荐形式，需要收集的反馈行为数据包括：

1. 用户是否打开了邮件。
2. 用户是否单击了邮件中的链接浏览促销产品。
3. 用户单击了之后是否会购买。
4. 用户直接单击“以后别给我发邮件了”。

反馈的目的在于评估推荐的效果，并根据效果来调整和优化推荐算法。基于所收集的用 户反馈行为的数据，亚马逊可以更好地提升其推荐算法的效率。

#### 6.2.3 推荐算法

推荐算法出现的原因是多方面的：人们置身于一个数据爆炸的时代。相比于过去的信息 匮乏，面对现阶段海量的信息数据，用户最头疼的是对海量信息的筛选和过滤。而一个具有 良好用户体验的系统，会将海量信息进行筛选、过滤，将用户最关注、最感兴趣的信息展现 在他们面前。这样可以大大提高系统工作的效率，同时也节省了用户筛选信息的时间。

搜索引擎的出现在一定程度上解决了信息和数据筛选的问题，但还远远不够。因为，要 使用搜索引擎，有一个前提条件，就是需要用户主动提供关键词来对海量信息进行筛选。但 当用户无法准确描述自己的需求时，搜索引擎的筛选效果将大打折扣，而用户将自己的需求 和意图转化成关键词的过程本身就是一个并不轻松的过程。况且很多时候，用户并不清楚自 己需要寻找什么样的物品。这就需要推荐算法的帮助。

推荐系统(图6-7)的任务就在于联系用户和信息， 一方面帮助用户发现对自己有价值 的信息，而另一方面让信息能够展现在对它感兴趣的人群中，从而实现信息提供商与用户的 双赢。

![图6-7 推荐系统](图6-7_placeholder)

##### 6.2.3.1  基于人口统计学的推荐算法

这是最为简单的一种推荐算法，它只是简单地根据系统用户的基本信息发现用户的相关 程度，然后将相似用户喜爱的其他物品推荐给当前用户。

首先会根据用户的属性建模，比如用户的年龄、性别、兴趣等信息。然后，根据这些特 征计算用户间的相似度，再实现推荐。比如，图6-8中，通过计算发现用户A 和用户 C 比 较相似，而用户A 喜欢物品A, 因此会尝试把物品A 推荐给用户C。

基于人口统计学的推荐算法的优势在于：不需要历史数据，没有冷启动问题；不依赖于 物品的属性，因此其他领域的问题都可无缝接入。但其不足之处在于，这种算法比较粗糙， 效果很难令人满意，只适合简单的推荐。

![图6-8 基于人口统计学的推荐](图6-8_placeholder)

##### 6.2.3.2  基于内容的推荐

基于内容的推荐 (Content-based    Recommendation) 是信息过滤技术的延续与发展，它是 建立在项目的内容信息上做出推荐的，而不需要依据用户对项目的评价意见，更多地需要用 机器学习的方法从关于内容的特征描述的事例中得到用户的兴趣资料。

在基于内容的推荐系统中，项目或对象是通过相关特征的属性来定义的，系统基于用 户评价对象的特征、学习用户的兴趣，考察用户资料与待预测项目的匹配程度。用户的资 料模型取决于所用的学习方法，常用的有决策树、神经网络和基于向量的表示方法等。基 于内容的用户资料需要有用户的历史数据，用户资料模型可能随着用户的偏好改变而发生 变化。

基于内容的推荐与基于人口统计学的推荐有类似的地方，只不过系统评估的中心转到了 物品本身，使用物品本身的相似度而不是用户的相似度来进行推荐。

首先要对物品的属性进行建模，图6-9用类型作为属性。在实际应用中，只根据类型做 出判断显然过于粗糙，还需要考虑演员、导演等更多信息。通过相似度计算，发现电影 A 和 电影C 相似度较高，因为他们都属于爱情类。还会发现用户A 喜欢电影A, 由此得出结论： 用户 A 很可能对电影C 也感兴趣。于是将电影C 推荐给A。

基于内容的推荐算法的优势在于：对用户兴趣可以很好地建模，并通过对物品属性维度 的增加，获得更好的推荐精度。而不足之处就在于：①物品的属性有限，很难有效得到更多 数据；②物品相似度的衡量标准只考虑到了物品本身，有一定的片面性；③需要用户的物 品的历史数据，有冷启动的问题。

![图6-9 基于内容的推荐](图6-9_placeholder)

##### 6.2.3.3  基于协同过滤的推荐算法

基于协同过滤的推荐算法(Collaborative   Filtering   Recommendation) 技术是推荐系统中应 用最早和最为成功的技术之一。它一般采用最近邻技术，利用用户的历史喜好信息计算用户 之间的距离，然后利用目标用户的最近邻居用户对商品评价的加权评价值来预测目标用户对 特定商品的喜好程度，从而根据这一喜好程度来对目标用户进行推荐。

基于协同过滤的推荐算法最大优点是对推荐对象没有特殊的要求，能处理非结构化的复 杂对象，如音乐、电影。

基于协同过滤的推荐算法是基于这样的假设：为一用户找到他真正感兴趣的内容的好方 法是首先找到与此用户有相似兴趣的其他用户，然后将他们感兴趣的内容推荐给此用户。其 基本思想非常易于理解，在日常生活中，人们往往会利用好朋友的推荐来进行一些选择。基 于协同过滤的推荐算法正是把这一思想运用到电子商务推荐系统中来，基于其他用户对某一 内容的评价来向目标用户进行推荐。

基于协同过滤的推荐系统可以说是从用户的角度来进行相应推荐的，而且是自动的，即 用户获得的推荐是系统从购买模式或浏览行为等隐式获得的，不需要用户努力地找到适合自 己兴趣的推荐信息，如填写一些调查表格等。

基于协同过滤的推荐算法具有如下优点：

1. 能够过滤难以进行机器自动内容分析的信息，如艺术品、音乐等。
2. 共享其他人的经验，避免了内容分析的不完全和不精确，并且能够基于一些复杂的， 难以表述的概念(如信息质量、个人品位)进行过滤。
3. 有推荐新信息的能力。可以发现内容上完全不相似的信息，用户对推荐信息的内容事 先是预料不到的。这也是基于协同过滤的推荐算法和基于内容的推荐一个较大的差别，基于 内容的推荐很多都是用户本来就熟悉的内容，而基于协同过滤的推荐可以发现用户潜在的但 自己尚未发现的兴趣偏好。
4. 能够有效地使用其他相似用户的反馈信息，减少用户的反馈量，加快个性化学习 的速度。

虽然基于协同过滤的推荐算法作为一种典型的推荐技术有其相当的应用，但协同过滤仍

有许多的问题需要解决。最典型的问题有稀疏问题 (Sparsity)和可扩展问题 (Scalability)。

##### 6.2.3.4  基于关联规则的推荐

基于关联规则的推荐 (Association   Rule-based   Recommendation) 是以关联规则为基础， 把已购商品作为规则头，规则体为推荐对象。关联规则挖掘可以发现不同商品在销售过程中 的相关性，在零售业中已经得到了成功的应用。

管理规则就是在一个交易数据库中统计购买了商品集X 的交易中有多大比例的交易同时 购买了商品集 Y,  其直观的意义就是用户在购买某些商品的时候有多大倾向去购买另外一些 商品。比如购买牛奶的同时很多人会购买面包。

算法的第一步关联规则的发现最为关键且最耗时，是算法的瓶颈，但可以离线进行。其 次，商品名称的同义性问题也是关联规则的一个难点。

##### 6.2.3.5  基于效用的推荐

基于效用的推荐(Utility-based    Recommendation)是建立在对用户使用项目的效用情况上 计算的，其核心问题是怎样为每一个用户去创建一个效用函数，因此，用户资料模型很大程 度上是由系统所采用的效用函数决定的。

基于效用推荐的好处是它能把非产品的属性，如提供商的可靠性 (Vendor   Reliability) 和 产品的可得性 (Product   Availability) 等考虑到效用计算中。

##### 6.2.3.6  基于知识的推荐

基于知识的推荐(Knowledge-based     Recommendation)在某种程度是可以看成是一种推理 (Inference)   技术，它不是建立在用户需要和偏好基础上推荐的。

基于知识的方法因它们所用的功能知识不同而有明显区别。效用知识 (Functional   Knowledge)   是一种关于一个项目如何满足某一特定用户的知识，因此能解释需要和推荐的 关系，所以用户资料可以是任何能支持推理的知识结构，它可以是用户已经规范化的查询， 也可以是一个更详细的用户需要的表示。

##### 6.2.3.7  组合方式的推荐

由于各种推荐方法都有优缺点，所以在实际中，组合推荐 (Hybrid    Recommendation) 经
常被采用。研究和应用最多的是内容推荐和协同过滤推荐的组合。

最简单的做法就是分别用基于内容的方法和协同过滤推荐方法去产生一个推荐预测结 果，然后用某方法组合其结果。尽管从理论上有很多种推荐组合方法，但在某一具体问题 中并不见得都有效，组合推荐的一个最重要原则就是通过组合来避免或弥补各自推荐技术 的弱点。

在组合方式上，有研究人员提出了七种组合思路。

1. **加 权 (Weight)**:    加权多种推荐技术结果。
2. **变 换 (Switch)**:     根据问题背景和实际情况或要求决定变换采用不同的推荐技术。
3. **混 合 (Mixed)**:  同时采用多种推荐技术给出多种推荐结果，为用户提供参考。
4. **特征组合(Feature    Combination)**: 组合来自不同推荐数据源的特征被另一种推荐算法

所采用。
5. **层叠 (Cascade)**: 先用一种推荐技术产生一种粗糙的推荐结果，第二种推荐技术在此 推荐结果的基础上进一步做出更精确的推荐。
6. **特征扩充 (Feature     Augmentation)**: 将一种技术产生附加的特征信息嵌入另一种推荐 技术的特征输入中。
7. **元级别 (Meta-level)**: 用一种推荐方法产生的模型作为另一种推荐方法的输入。

### 6.3 潘多拉音乐组计划

#### 6.3.1 案例详析

让我们先来看一组数据：8000万以上的注册用户，80亿次以上的点击次数，用户月平 均在线时长达10小时以上，并且新用户以每秒一人的速度疯狂增长，占据着全美前20大网 络电台50%以上的市场份额(以时间计)。

它不是Facebook 或 Twitter 成长过程中的一段缩影，这是一家名为“潘多拉”的网络电 台。潘多拉媒体在2月份首次向SEC 提交了S-1   文 件 (IPO  文件),正准备向华尔街打开它 充满魔力的“潘多拉盒子”(图6-10)。

![图6-10 潘多拉音乐盒子](图6-10_placeholder)

先来看看潘多拉音乐盒子的创办故事：在创立潘多拉网络电台之前， CEO  蒂姆 ·威斯特 伦一直都是落魄的音乐人。20世纪90年代末，他在帕洛阿尔托假日酒店的一场特约演出中 倚着大屏幕电视机演奏钢琴，电视上正在播放美式橄榄球的最新战报。 一位球迷走过来，问 他能不能停下来，这样才能听清比分，威斯特伦回忆道：“那位球迷能看到比分，但他还想亲 耳听到。”那天晚上威斯特伦从酒店厨房领到免费汉堡之后，放弃了自己的演奏职业，开始考 虑其他音乐行当，并在2005年推出潘多拉网络电台服务。

潘多拉电台在官网中这样解释取名潘多拉的寓意：潘多拉是宙斯用黏土做成的第一个女 人，从希腊众神那儿得到了音乐等许多礼物，她出于好奇打开一个魔盒，从中释放出人世间 的所有邪恶：贪婪、虚无、诽谤、嫉妒、痛苦，等等。潘多拉网络电台正是取其音乐和好奇

心的双重寓意，通往音乐的发现之旅。

那潘多拉网络电台到底是如何吸引8000万注册用户的音乐好奇心的呢?

简单地讲，潘多拉网络电台其实就是一个高度个性化的“私人电台”。潘多拉通过分析用 户对所播放歌曲的反馈行为(喜欢或不喜欢)以及歌曲本身，随机推送基于用户习惯的音 乐。潘多拉网络电台不设置音乐播放列表，不能播放用户选定歌曲，完全颠覆了传统的播 放器模式。

##### 6.3.1.1  潘多拉音乐盒子的用户模式

1. **第一步**：用户在潘多拉音乐盒子网站注册，打开网页，网站上跳出一个简单精致的音乐 盒子。
2. **第二步**：用户输入一首自己喜欢风格的歌曲或者某歌手的名字。例如输入迈克 ·杰克逊 的 “Beat    It”, 然后单击潘多拉系统自动联想的第一个选项“Beat  It  by  Michael  Jackson”, 于 是 便创建了一个名为“Beat It”的私人电台(图6- 11),“Beat It”电台主要向用户推送与“Beat It”  风格类似的歌曲。

![图6-11 潘多拉网络电台](图6-11_placeholder)

3. **第三步**：与传统播放器不同，潘多拉电台并不是直接播放选择的歌曲 “Beat   It”, 而是推 送一首风格与 “Beat   It” 十分相近的 “The Way You Make Me Feel”(也可能是其他歌手的歌 曲)。
4. **第四步**：通过互动，潘多拉系统会根据用户的操作行为重新计算并修正用户个人的音乐 库，推送更加符合我们个人习惯的歌曲。例如，当潘多拉播放 “The Way You Make Me Feel” 时，如果我们点击喜欢(Thumbs-up),    那么潘多拉将推送更多与“The Way You Make Me Feel” 基因类似的音乐，而如果我们点击不喜欢(Thumbs-down),  潘多拉将推送那些和它差距越来 越大的音乐。
5. **第五步**：经过多次的相互反馈，潘多拉网络电台就会建立一个高度个性化的“私人电台”

(图6- 12)。

![图6-12 私人定制的电台音乐](图6-12_placeholder)

6. **第六步**：那如果厌倦了某种音乐风格怎么办?我们可以通过输入不同风格的歌曲新建另


一个“私人电台”,潘多拉网络电台允许每名用户最多 建立100个私人电台，然后潘多拉的系统将基于这首不 同风格的歌曲重新进行推送。潘多拉网络电台在 S-1  文件中透露，公司总计拥有14亿个“私人电台”,平均 每名注册用户拥有的“私人电台”达17 个左右(图 6-13)。

![图6-13 潘多拉电台App](图6-13_placeholder)

##### 6.3.1.2  音乐基因组计划

潘多拉网络音乐电台之所以会如此成功，要归功于 其背后的音乐基因组计划。潘多拉的CEO 威斯特伦， 在创立公司的最初专注于打造一款能够分析歌曲的音

乐推荐引擎，最后这成了潘多拉网络电台为用户推送音        乐的核心。

基因决定了我们和父母、亲戚的相近程度，也决定了我们的子女和我们的相近程度。而 潘多拉的音乐基因组计划旨在将音乐分解成基本的基因片段。其背后的想法是，我们喜欢一 段音乐是因为它的属性——为什么不利用音乐片段之间的相似性做一个音乐推荐系统呢?这 种类型的推荐引擎属于物品推荐 (Item     Recommendation)。但是令人印象深刻的是，像一段 音乐这样的物品，它的相似度需要通过它的“基因”构成来衡量。

据潘多拉网络电台在 IPO 文件中透露，公司的“音乐组计划”中收录了超过80万首经 过单独分析的歌曲，这些歌曲来自8万名歌手。“基因组计划”对收录的每一首新歌依据其旋 律、和声、配器、歌词等总计480项音乐属性进行分析归类，这样的工作基本上都由潘多拉 网络电台的音乐分析师完成。只要潘多拉网络电台还能继续运转下去，音乐分析师的歌曲分 析工作就不会停止，潘多拉网络电台是互联网中名副其实的劳动密集型企业。

那么让我们结合音乐基因组计划来看看潘多拉网络电台的工作原理：

1. **第一步**：当用户输入 “Beat    It” 创建个性化电台时，潘多拉网络电台首先在其自己的音 乐库中搜索到 “Beat   It”。
2. **第二步**：潘多拉系统运用基因组计划中的数据对它的旋律、和声、配器、歌词等属性进

行分析，找出该歌曲在480项音乐属性上各自的特征。
3. **第三步**：通过某种算法在海量的音乐库中搜寻与其风格类似的歌曲，和音乐分析师分析 歌曲一样，匹配过程中参照的音乐属性达480项。
4. **第四步**：推荐找到的歌曲，并记录用户对推荐结果的反馈。通过用户的“认可”“拒绝” 等判断来评估它推荐的曲目，从而根据不断地反馈推断出用户属于哪类听众，喜欢什么,不   喜欢什么等，帮助优化之后的推荐。

用户在享受了潘多拉所提供的特色推荐的同时，他们的互动其实也在帮助潘多拉更好地 改进推荐系统。

潘多拉网络电台的系统在匹配过程中完全不考虑歌手的知名度或者歌曲的流行程度，对 所有的歌曲都一视同仁。它推送的歌曲非常符合听众的个性化需求，许多听众都能在潘多拉 网络电台发现“失散多年”的老歌，或者发掘出默默无闻的歌手的作品。潘多拉网络电台推 送的每一首歌都能激起听众的音乐好奇心。

#### 6.3.2  标签的运用

潘多拉网络电台的独到之处在于它完全可以根据一首歌的本身属性探究音乐相似性背后 的因素，而不需要了解用户的喜好就可以把用户粘住，真正实现了通过技术向用户智慧地推 荐音乐的目的。这正是基因组计划工作的原理所在——将一个复杂的问题切割成对很多小的 特性的描述，从而予以解决。

随着这种“基因”概念的普及，人们很自然地想到，可不可以把这种推荐方法应用于其他产品呢?比如图书、视频、电影、食物等。这时，“标签”就发挥了作用。

先来看一下目前的推荐算法的工作方式(图6-14)。基本上可以把它们分为三类：
第一种方式是通过用户喜欢过的物品：可以给用户推荐与他喜欢过的物品相似的物品；
第二种方式是通过和用户兴趣相似的其他用户：可以给用户推荐那些和他们兴趣爱好相 似的其他用户喜欢的物品；
第三个方式是通过一些特征 (Feature)    来联系用户：可以给用户推荐那些具有用户喜欢
的特征的物品。

![图6-14 推荐的方式](图6-14_placeholder)

让我们来关注第三种方式，这里所指的特征，有不同的表现方式，比如可以表现为物品 的属性集合(比如对于图书，属性集合就包括了作者、出版社、主题和关键词等),也可以表 现为隐语义向量 (Latent Factor Vector)。而其中最重要的一种特征表现方式就是标签。

所谓的标签，我们可以理解为一种无层次化结构的、用来描述信息的关键词，它可以用 来准确地描述物品的语义。

运用好标签，可以帮助人们更好地刻画事物的特征，更好地推荐相应的特性。

##### 6.3.2.1     Delicious

Delicious 网站可以算是标签系统里的鼻祖，是目前网络上最大的书签类站点。它是一个 帮助用户共享他们喜欢网站链接的流行网站。

标签的作用就是可以让人们对某一条目进行标注，如添加词语以及短语。对于Delicious 网站而言，所进行标注的条目就是书签。

Delicious 提供了一种简单共享网页的方法，它为无数互联网用户提供一种服务——对他 们喜欢的网页书签进行分类。

如图6- 15 所示，每一个网页下方都显示了相关联的标签名称，从而帮助之前没有浏览 过这些网页的人们快速了解网页大致内容。

![4（此处实际应为图6-15相关示意描述，因文本形式无法直接展示图片，以下为示意性文字）
示例网页下方显示标签：CHom·Brea, New%, US, Word, Weather, Entertainment, vid, 
Aunx, Elect, The actien-prched journy s us sfaeton dar in gnaph Bnncam, cy, wy, 4
Bonnu, Proaldamt, Reum-Electlen, 2012-NYTemescen, acm, ta, 24
Tha NwYern Tim-2raking H, Wert, NemuNed c
How to Le newFTPINemes t com
A3npao, Pralr, Scrollhng, Technique (Nes
cmi
The Pele
n t](图6-15_示意描述)

![图6-15 Delicious网站](图6-15_placeholder)

##### 6.3.2.2    Lastfm

Lastfm 是 Audioscrobbler   音乐引擎设计团队的旗舰产品，以英国为总部的网络电台和音 乐社区，有遍布232个国家超过1500万的活跃听众。2007年被CBS   Interactive以2.8亿 美元价格收购。它是世界上最大的社交音乐平台。音乐库里有超过1亿首歌曲曲目(其中300 多万首可以收听)和超过1000万的歌手。每个月，全世界250个国家，2000万人在这里寻 找、收听、谈论自己喜欢的音乐。这个数字还在不断增长。

Lastfm 是一个音乐推荐服务，你通过注册账户和下载The  Scrobbler软件开始使用Lastfm 服务。The Scrobbler根据播放过的曲目帮你发现更多音乐。它通过分析用户的听歌行为来预 测用户对音乐的兴趣，从而给用户推荐个性化的音乐。

Lastfm 的“Audioscrobb”(同步记录)基本上是一种“懒人找新音乐”的办法——你不 需要做什么,只要在自己的计算机上安装一个客户端软件，此后每在计算机、iPod 或者iTunes  上播放一首音乐，这个软件都会忠实地记录下来，分析哪首歌曲播放的次数最多，然后自动 向在Lastfm 上的个人音乐主页添加元数据，推荐你可能喜欢的新音乐。你可以随意地听，也 可以做一些简单的操作，表示你喜欢或者跳过、禁止这首音乐。这个私人电台还会深入你的

音乐。

图6 - 16中展示了在Lastfm  网站上搜索The   Beatles 乐队的结果，可以看到，网站上展示 了 the   Beatles乐队相关联的标签。也许人们并不了解 The   Beatles乐队，但是通过这些标签就 能知道 the  Beatles 乐队是活跃在20世纪60年代的，英国的一组传统摇滚乐队。

![classic rock·rock·60s·the beatles·british·pop
The Beatles were an iconnc rock group from Lverpool,England.They are frequentty cited as the most commerciaty    successful and criticaly acclaimed band in modern history.with innovative music acultural mpact that heiped define
the 19605 and an enormousinfuence on music that is stll felt today.Currently.The Beatles are one of the two
musical acts to sell more than t bilion records,with only Evs Presley havng been able to achleve the same feat.After
conquermg Europe...read more

Top Tracks
◎ 2Come   Together
Let  储Be
3             2Yesterday
4         ①  Help!
5       )    Here Comes the Sun](图6-16_示意描述)

![图6-16 Lastfm 网站](图6-16_placeholder)

##### 6.3.2.3   CiteULike

作为一名科研人员或准科研人员，甚至是一名有志做点学问的研究生，不可避免地要阅 读大量论文，很多时候这种工作是在网上完成的。那么你是否会有这样的烦恼：当你读完一 篇论文时，发现它引用的另外一篇或多篇文献对你来说可能更有用，所以你想先把这个/这些 引用保存下来，留作日后再读。这个工作耗费了大量的时间，复制粘贴，外部存储，建立目 录，分类等，关键是还不能方便索引。如果考虑到做一项研究一共需要阅读的文献量的话， 那么这个工作就变得不那么简单了。

CiteULike   是一个著名的论文书签网站。它允许研究人员提交或者收藏他们感兴趣的论 文，并给论文打标签，从而帮助用户更好地发现和自己研究领域相关的优秀论文。这样，通 过群体智能，让每个研究人员对自己了解的论文进行标记，从而帮助用户更好更快地发现自 己感兴趣的论文。

就像图6- 17所示，图中展示了CiteULike   中一篇被用户打的标签最多的有关推荐系统 评测的文章，可以发现，最多的两个标签是协同过滤(Collaborative-filtering)和评测(Evaluate), 确实比较准确地反映了这篇论文的主要内容。

![Evaluation of recommender systems:A new approach                              Tags
by:   F.Hernandezdelolmo,E.Gaudioso
Expert                   systems                    with                    Applications,Vol.35,No.3.(October                   2008),pp.790-804.doi:10.1016/j.eswa.2007.07.047
Key:citeulike:2944736
Fnd   related   artides   with   these    CkteULike   tags
·so llaborative-fitening,evaluate, evaluation,fndodf,framework,iournal,metnics, no-taa, ree, recommendation, nConmender. recommender svstem,recommender svstems, recVs,reC5Y5 evaluation,resYs,rs,  sYstem](图6-17_示意描述)

![图6-17 CiteULike](图6-17_placeholder)

##### 6.3.2.4     Hulu

在美国，Hulu  已是最受欢迎的视频网站之一。根据尼尔森的调查，Hulu 将 Google  Video 挤出局成为全美排名第10的视频网站，其与合作网站的视频观众人数超过美国所有电视台网 站的独立访客人数。

Hulu 引入了用户标签系统来让用户对电视剧和电影进行标记(图6-18)。

![图6- 18 Hulu](图6-18_placeholder)

图6-18展示了美剧《豪斯医生》的常用标签，可以看到， Hulu 对标签做了分类，并展 示了每一类最热门的标签。从类型 (Genre)    看，豪斯医生是一部医学片 (Medical    Drama);   从时间看，这部剧开始于2004年；从人物看，这部美剧的主演是休 · 劳瑞，他在剧中饰演的 人物是格雷 · 豪斯。

### 6.4  塔吉特的大数据营销

#### 6.4.1  案 例 详 析

美国第二大超市塔吉特 (Target)   是最早利用大数据的零售商，他们拥有专业顾客数据分 析模型，可通过对购买行为的精确分析，判断出早期怀孕人群的类别，然后先于同行精准地 向他们营销商品。

2012年，在美国发生了一件趣闻， 一名男子闯入了他家附近的超市      塔吉特，“你们 怎么能这样!”男人向店铺经理大吼道，“你们竟然给我17岁的女儿发婴儿尿片和童车的优惠 券，她才17岁啊!”店铺经理不知道发生了什么,立刻向来者道歉，表明那肯定是个误会。 然而，经理没有意识到，公司正在运行一套大数据系统。 一个月后，这个愤怒的父亲打来电 话道歉，因为塔吉特发来的婴儿用品促销广告并不是误发，他的女儿的确怀孕了。塔吉特比 这位父亲知道他女儿怀孕的时间足足早了一个月(图6-19)。

问题就出在这里，超市怎么会知道这位17岁的女孩怀孕了呢?

孕妇对于零售商来说是个含金量很高的顾客群体。但是孕妇一般会去专门的孕妇商店而 不是在塔吉特购买孕期用品。人们一提起塔吉特，往往想到的都是清洁用品、袜子和卫生纸 之类的日常生活用品，却忽视了塔吉特有孕妇需要的一切。那么塔吉特有什么办法可以把这部分细分顾客从孕妇产品专卖店的手里截留下来呢?

在美国出生记录是公开的，等孩子出生了，新生儿母亲就会被铺天盖地的产品优惠广告 包围。那时再行动就晚了，必须赶在孕妇第2个妊娠期行动起来。如果能够赶在所有零售商 之前知道哪位顾客怀孕了，塔吉特的市场营销部门就可以早早地给他们发出量身定制的孕妇 优惠广告，早早圈定宝贵的顾客资源。

怀孕是很私密的信息，那如何能够准确地判断哪位顾客怀孕了呢?原来，塔吉特有一个 迎婴聚会的登记表。他们对这些登记表里的顾客的消费数据进行建模分析，从中发现了许多 非常有用的数据模式。比如，许多孕妇从第2个妊娠期开始，便会购买许多大包装的无香味 护手霜；在怀孕的最初20周，大量购买补充钙、镁、锌的善存片之类的保健品。

最后他们选出了25种典型商品的消费数据，构建了“怀孕预测指数”,通过这个指数， 塔吉特能够在很小的误差范围内预测出顾客的怀孕情况，因此，塔吉特就能精确地把孕妇优 惠广告寄发给顾客。塔吉特把孕妇用品的优惠广告夹杂在其他一大堆与怀孕不相关的商品优 惠广告当中，这样顾客就不知道塔吉特判断出她怀孕了，塔吉特做到了没有干扰的销售。

结果，其孕期用品销售呈现了爆炸性的增长。2002—2010年，塔吉特的销售额从440亿 美元增长到了670亿美元。大数据的巨大威力轰动了全美。难以想象，许多孕妇在浑然不知 的情况下成了塔吉特的忠实顾客，许多孕妇产品专卖店也在浑然不知中破产。

不仅如此，如果用户从他们的店铺中购买了婴儿用品，塔吉特在接下来的几年中会根据 婴儿的生长周期情况定期给这些顾客推送相关产品，使这些客户形成长期的忠诚度。

如果不是在拥有海量的用户交易数据基础上实施数据挖掘，塔吉特不可能做到如此精准 的营销。

#### 6.4.2 思维启示——数据应用已经渗入生活的方方面面

塔吉特这个案例为何给人如此强烈的印象?原因在于，数据的力量，不仅让商家提升了 自己的业绩，还让客户为之心甘情愿买单。不仅如此，塔吉特的大数据分析技术还从孕妇这 个细分顾客群开始向其他各种细分客户群推广。

塔吉特的大数据系统会给每一个顾客编一个ID 号。刷信用卡、使用优惠券、填写调查问

卷、邮寄退货单、打客服电话、开启广告邮件、访问官网，所有这一切行为都会记录进客户 的 ID 号。而且这个ID 号还会对号入座的记录下人口统计信息：年龄、是否已婚、是否有子 女、所住市区、住所离塔吉特的车程、薪水情况、最近是否搬过家、钱包里的信用卡情况、 常访问的网址等。

塔吉特还可以从其他相关机构那里购买客户的其他信息：种族、就业史、喜欢读的杂志、 破产记录、婚姻史、购房记录、求学记录、阅读习惯等。在大数据分析部那里，这些看似无 用的数据却可以爆发强劲的威力。

在商业领域，大数据就是像 Target 那样收集起来的关于消费者行为的海量相关数据。这 些数据超越了传统的存储方式和数据库管理工具的功能范围，必须用到大数据存储、搜索、 分析和可视化技术(比如云计算)才能挖掘出巨大商业价值。

实际上，诸如沃尔玛、Tesco (英国零售巨头)等巨头已从数据中获得了巨大的利益，也 因此巩固了自己在业界的长盛不衰的地位。以 Tesco 为例，这家全球利润位居第二的零售商 从其会员卡的用户购买记录中，充分了解到一个用户是什么“类别”的客人，如素食者、单 身、有上学孩子的家庭等，并基于这些分类进行一系列的业务活动。比如，通过邮件或信件 寄给用户的促销可以变得十分个性化，店内的上架商品及促销也可以根据周围人群的喜好、  消费的时段而更加有针对性，从而提高货品的流通。这样的做法为Tesco 获得了丰厚的回报， 仅在市场宣传一项，就能帮助Tesco 每年节省3.5亿英镑的费用。

在互联网行业，大数据更是为电商、广告商们提供了丰厚的回报。雅虎于2008年年初便 开始启用大数据技术，每天分析超过200 PB 的数据，使雅虎的服务变得更人性化，更贴近用 户。它与雅虎IT 系统的方方面面进行协作，包括搜索、广告、用户体验和欺诈发现等。 AOL  也设立了300 节点的服务器集群，将在其下属系列网站(如 AOL.com 、Huffington   Post 、 MapQuest 等)中，将每天500 TB 的用户浏览信息收集起来，分析和预测这些用户的行为， 以便有针对性地为每个月1.8亿独立用户进行个性化广告服务。

对亚马逊而言，数据技术的应用更是为其成为一家“信息公司”、独占电商领域鳌头奠定 了稳定的基础。为了更深入地了解每一个用户，亚马逊不仅从每个用户的购买行为中获得信 息，还将每个用户在其网站上的所有行为都记录了下来：每个页面的停留时间、用户是否查 看Review、每个搜索的关键词、每个浏览的商品等，在亚马逊2012年11月推出的Kindle Fire 中，内嵌的 Silk 浏览器更是可以将用户的行为数据一一记录下来。这些数据的有效分析，使 亚马逊对于客户的购买行为和喜好有了全方位的了解，对于其货品种类、库存、仓储、物流 及广告业务，都有着极大的效益回馈。

数据技术的应用不仅在零售和互联网行业获得极大回报，其带来的经济价值使各行业均  为之“折腰”。在能源行业，Opower 使用数据来提高消费用电的效能，并取得了显著的成功。 作为一家提供 SaaS 服务(软件服务)的创新公司， Opower 与多家电力公司合作，分析美国 家庭用电费用，并将之与周围的邻居用电情况进行对比，被服务的家庭每个月都会收到一份 对比报告，显示自家用电在整个区域或全美类似家庭所处水平，以鼓励节约用电。 Opower  的服务覆盖了美国几百万户居民家庭，预计每年为美国消费用电节省5亿美元。

### 总结（AI生成）

通过对“啤酒与尿布”案例的深入分析，我们了解到大数据在零售业中的巨大应用潜力。沃尔玛通过先进的技术和数据分析方法，成功挖掘出了商品之间的关联关系，并据此优化了商品陈列和促销策略，从而显著提升了销售额。这一案例启示我们，在大数据时代，必须具备全局观念，注重商品之间的相关性研究，并深挖数据背后的含义，以制定更为精准有效的营销策略。

亚马逊的个性化推荐系统则展示了大数据在电商领域的广泛应用。通过收集和分析用户的浏览、购买等行为数据，亚马逊能够为用户提供高度个性化的商品推荐，从而极大地提升了用户体验和购买转化率。这一案例告诉我们，大数据不仅能够帮助企业更好地了解用户需求，还能够通过精准营销实现商业价值的最大化。

潘多拉音乐组计划和标签的运用则进一步拓展了大数据的应用范围。通过音乐基因组计划和标签系统，潘多拉能够为用户提供高度个性化的音乐推荐服务，从而吸引了大量用户并保持了较高的用户粘性。这一案例启示我们，大数据的应用不仅限于零售和电商领域，还可以广泛应用于音乐、视频等娱乐产业，通过精准推荐提升用户体验和满意度。

最后，塔吉特的大数据营销案例则展示了大数据在精准营销方面的巨大威力。通过构建“怀孕预测指数”等模型，塔吉特能够精准地预测出顾客的怀孕情况，并据此向顾客推送个性化的商品推荐和优惠信息。这一案例告诉我们，大数据的应用需要紧密结合业务需求，通过构建精准的数据模型和分析方法，实现商业价值的最大化。

综上所述，大数据已经成为当今社会不可或缺的重要资源。通过深入挖掘和分析大数据中的价值信息，企业能够制定更为精准有效的营销策略，提升用户体验和满意度，从而实现商业价值的最大化。
